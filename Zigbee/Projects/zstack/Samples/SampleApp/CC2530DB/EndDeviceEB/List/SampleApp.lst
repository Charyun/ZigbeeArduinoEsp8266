###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         31/May/2018  12:15:04 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\Source\Samp #
#                          leApp.c                                            #
#    Command line       =  -f C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack #
#                          -2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB #
#                          \..\..\..\Tools\CC2530DB\f8wEndev.cfg (-DCPU32MHZ  #
#                          -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3         #
#                          -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f          #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\Tools\CC2530DB\f8wConfig.cfg (-DZIGBEEPRO   #
#                          -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR       #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFF1                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 C:\Users\chaizong\Desktop\Z #
#                          igbee_Arduino\ZStack-2.5.1a\Projects\zstack\Sample #
#                          s\SampleApp\Source\SampleApp.c -D NWK_AUTO_POLL    #
#                          -D ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D           #
#                          MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG -lC             #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\En #
#                          dDeviceEB\List\ -lA C:\Users\chaizong\Desktop\Zigb #
#                          ee_Arduino\ZStack-2.5.1a\Projects\zstack\Samples\S #
#                          ampleApp\CC2530DB\EndDeviceEB\List\                #
#                          --diag_suppress Pe001,Pa010 -o                     #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\En #
#                          dDeviceEB\Obj\ -e --no_code_motion --debug         #
#                          --core=plain --dptr=16,1 --data_model=large        #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I C:\Users\chaizong\Desktop\ #
#                          Zigbee_Arduino\ZStack-2.5.1a\Projects\zstack\Sampl #
#                          es\SampleApp\CC2530DB\ -I                          #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \Source\ -I C:\Users\chaizong\Desktop\Zigbee_Ardui #
#                          no\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp #
#                          \CC2530DB\..\..\..\ZMain\TI2530DB\ -I              #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\hal\include\ -I            #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\hal\target\CC2530EB\ -I    #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\mac\include\ -I            #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\mac\high_level\ -I         #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\mac\low_level\srf04\ -I    #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\mac\low_level\srf04\single #
#                          _chip\ -I C:\Users\chaizong\Desktop\Zigbee_Arduino #
#                          \ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\C #
#                          C2530DB\..\..\..\..\..\Components\mt\ -I           #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\osal\include\ -I           #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\services\saddr\ -I         #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\services\sdata\ -I         #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\stack\af\ -I               #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\stack\nwk\ -I              #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\stack\sapi\ -I             #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\stack\sec\ -I              #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\stack\sys\ -I              #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\stack\zdo\ -I              #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\zmac\ -I                   #
#                          C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\.. #
#                          \..\..\..\..\Components\zmac\f8w\ -Ohz             #
#                          --require_prototypes                               #
#    List file          =  C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\En #
#                          dDeviceEB\List\SampleApp.lst                       #
#    Object file        =  C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2. #
#                          5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\En #
#                          dDeviceEB\Obj\SampleApp.r51                        #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\chaizong\Desktop\Zigbee_Arduino\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c
      1          /**************************************************************************************************
      2            Filename:       SampleApp.c
      3            Revised:        $Date: 2009-03-18 15:56:27 -0700 (Wed, 18 Mar 2009) $
      4            Revision:       $Revision: 19453 $
      5          
      6            Description:    Sample Application (no Profile).
      7          
      8          
      9            Copyright 2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41            This application isn't intended to do anything useful, it is
     42            intended to be a simple example of an application's structure.
     43          
     44            This application sends it's messages either as broadcast or
     45            broadcast filtered group messages.  The other (more normal)
     46            message addressing is unicast.  Most of the other sample
     47            applications are written to support the unicast message model.
     48          
     49            Key control:
     50              SW1:  Sends a flash command to all devices in Group 1.
     51              SW2:  Adds/Removes (toggles) this device in and out
     52                    of Group 1.  This will enable and disable the
     53                    reception of the flash command.
     54          *********************************************************************/
     55          
     56          /*********************************************************************
     57           * INCLUDES
     58           */
     59          #include "OSAL.h"
     60          #include "ZGlobals.h"
     61          #include "AF.h"
     62          #include "aps_groups.h"
     63          #include "ZDApp.h"
     64          
     65          #include "SampleApp.h"
     66          #include "SampleAppHw.h"
     67          
     68          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0xf3
   \   unsigned char volatile __sfr P0SEL
   \                     P0SEL:
   \   000000                DS 1
     69          
     70          /* HAL */
     71          #include "hal_lcd.h"
     72          #include "hal_led.h"
     73          #include "hal_key.h"
     74          #include "MT_UART.h"
     75          #include "MT_APP.h"
     76          #include "MT.h"
     77          
     78          
     79          #include "DHT11.h"
     80          #include "uart.h"
     81          #include "sensor.h"
     82          /*********************************************************************
     83           * MACROS
     84           */
     85          
     86          /*********************************************************************
     87           * CONSTANTS
     88           */
     89          
     90          /*********************************************************************
     91           * TYPEDEFS
     92           */
     93          
     94          /*********************************************************************
     95           * GLOBAL VARIABLES
     96           */

   \                                 In  segment XDATA_I, align 1, keep-with-next
     97          uint8 AppTitle[] = "ALD Broadcast"; //应用程序名称
   \                     AppTitle:
   \   000000                DS 14
   \   00000E                REQUIRE `?<Initializer for AppTitle>`
   \   00000E                REQUIRE __INIT_XDATA_I
     98          
     99          // This list should be filled with Application specific Cluster IDs.

   \                                 In  segment XDATA_ROM_C, align 1
    100          const cId_t SampleApp_ClusterList[SAMPLEAPP_MAX_CLUSTERS] =
   \                     SampleApp_ClusterList:
   \   000000   0100         DW 1
   \   000002   0200         DW 2
    101          {
    102            SAMPLEAPP_PERIODIC_CLUSTERID,
    103            SAMPLEAPP_FLASH_CLUSTERID
    104          };
    105          

   \                                 In  segment XDATA_ROM_C, align 1
    106          const SimpleDescriptionFormat_t SampleApp_SimpleDesc =
   \                     SampleApp_SimpleDesc:
   \   000000   14           DB 20
   \   000001   080F         DW 3848
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   02           DB 2
   \   000007   ....         DW SampleApp_ClusterList
   \   000009   02           DB 2
   \   00000A   ....         DW SampleApp_ClusterList
    107          {
    108            SAMPLEAPP_ENDPOINT,              //  int Endpoint;
    109            SAMPLEAPP_PROFID,                //  uint16 AppProfId[2];
    110            SAMPLEAPP_DEVICEID,              //  uint16 AppDeviceId[2];
    111            SAMPLEAPP_DEVICE_VERSION,        //  int   AppDevVer:4;
    112            SAMPLEAPP_FLAGS,                 //  int   AppFlags:4;
    113            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
    114            (cId_t *)SampleApp_ClusterList,  //  uint8 *pAppInClusterList;
    115            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
    116            (cId_t *)SampleApp_ClusterList   //  uint8 *pAppInClusterList;
    117          };
    118          
    119          // This is the Endpoint/Interface description.  It is defined here, but
    120          // filled-in in SampleApp_Init().  Another way to go would be to fill
    121          // in the structure here and make it a "const" (in code space).  The
    122          // way it's defined in this sample app it is define in RAM.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    123          endPointDesc_t SampleApp_epDesc;
   \                     SampleApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z
    124          
    125          /*********************************************************************
    126           * EXTERNAL VARIABLES
    127           */
    128          
    129          /*********************************************************************
    130           * EXTERNAL FUNCTIONS
    131           */
    132          
    133          /*********************************************************************
    134           * LOCAL VARIABLES
    135           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    136          uint8 SampleApp_TaskID;   // Task ID for internal task/event processing
   \                     SampleApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    137                                    // This variable will be received when
    138                                    // SampleApp_Init() is called.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    139          devStates_t SampleApp_NwkState;
   \                     SampleApp_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    140          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    141          uint8 SampleApp_TransID;  // This is the unique message ID (counter)
   \                     SampleApp_TransID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    142          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    143          afAddrType_t SampleApp_Periodic_DstAddr;
   \                     SampleApp_Periodic_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    144          afAddrType_t SampleApp_Flash_DstAddr;
   \                     SampleApp_Flash_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
    145          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    146          aps_Group_t SampleApp_Group;
   \                     SampleApp_Group:
   \   000000                DS 18
   \   000012                REQUIRE __INIT_XDATA_Z
    147          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    148          uint8 SampleAppPeriodicCounter = 0;
   \                     SampleAppPeriodicCounter:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    149          uint8 SampleAppFlashCounter = 0;
   \                     SampleAppFlashCounter:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    150          
    151          /*********************************************************************
    152           * LOCAL FUNCTIONS
    153           */
    154          void SampleApp_HandleKeys( uint8 shift, uint8 keys );
    155          void SampleApp_MessageMSGCB( afIncomingMSGPacket_t *pckt );
    156          void SampleApp_SendPeriodicMessage( void );
    157          void SampleApp_SendFlashMessage( uint16 flashTime );
    158          void SampleApp_SerialCMD(mtOSALSerialData_t *cmdMsg);
    159          
    160          /*********************************************************************
    161           * NETWORK LAYER CALLBACKS
    162           */
    163          
    164          /*********************************************************************
    165           * PUBLIC FUNCTIONS
    166           */
    167          
    168          /*********************************************************************
    169           * @fn      SampleApp_Init
    170           *
    171           * @brief   Initialization function for the Generic App Task.
    172           *          This is called during initialization and should contain
    173           *          any application specific initialization (ie. hardware
    174           *          initialization/setup, table initialization, power up
    175           *          notificaiton ... ).
    176           *
    177           * @param   task_id - the ID assigned by OSAL.  This ID should be
    178           *                    used to send messages and set timers.
    179           *
    180           * @return  none
    181           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    182          void SampleApp_Init( uint8 task_id )
   \                     SampleApp_Init:
    183          { 
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    184            SampleApp_TaskID = task_id;
   \   000007   90....       MOV     DPTR,#SampleApp_TaskID
   \   00000A   F0           MOVX    @DPTR,A
    185            SampleApp_NwkState = DEV_INIT;
   \   00000B   90....       MOV     DPTR,#SampleApp_NwkState
   \   00000E   7401         MOV     A,#0x1
   \   000010   F0           MOVX    @DPTR,A
    186            SampleApp_TransID = 0;
   \   000011   90....       MOV     DPTR,#SampleApp_TransID
   \   000014   E4           CLR     A
   \   000015   F0           MOVX    @DPTR,A
    187            
    188            MT_UartInit();                  //串口初始化
   \   000016                ; Setup parameters for call to function MT_UartInit
   \   000016   12....       LCALL   ??MT_UartInit?relay
    189            MT_UartRegisterTaskID(task_id); //注册串口任务
   \   000019                ; Setup parameters for call to function MT_UartRegisterTaskID
   \   000019   EE           MOV     A,R6
   \   00001A   F9           MOV     R1,A
   \   00001B   12....       LCALL   ??MT_UartRegisterTaskID?relay
    190            HalUARTWrite(0,"UartInit OK\n", sizeof("UartInit OK\n"));//提示信息
   \   00001E                ; Setup parameters for call to function HalUARTWrite
   \   00001E   7C0D         MOV     R4,#0xd
   \   000020   7D00         MOV     R5,#0x0
   \   000022   7A..         MOV     R2,#`?<Constant "UartInit OK\\n">` & 0xff
   \   000024   7B..         MOV     R3,#(`?<Constant "UartInit OK\\n">` >> 8) & 0xff
   \   000026   7900         MOV     R1,#0x0
   \   000028   12....       LCALL   ??HalUARTWrite?relay
    191            P0SEL &= 0x7f;                  //P0_7配置成通用io
   \   00002B   53F37F       ANL     0xf3,#0x7f
    192            
    193            // Device hardware initialization can be added here or in main() (Zmain.c).
    194            // If the hardware is application specific - add it here.
    195            // If the hardware is other parts of the device add it in main().
    196          
    197           #if defined ( BUILD_ALL_DEVICES )
    198            // The "Demo" target is setup to have BUILD_ALL_DEVICES and HOLD_AUTO_START
    199            // We are looking at a jumper (defined in SampleAppHw.c) to be jumpered
    200            // together - if they are - we will start up a coordinator. Otherwise,
    201            // the device will start as a router.
    202            if ( readCoordinatorJumper() )
    203              zgDeviceLogicalType = ZG_DEVICETYPE_COORDINATOR;
    204            else
    205              zgDeviceLogicalType = ZG_DEVICETYPE_ROUTER;
    206          #endif // BUILD_ALL_DEVICES
    207          
    208          #if defined ( HOLD_AUTO_START )
    209            // HOLD_AUTO_START is a compile option that will surpress ZDApp
    210            //  from starting the device and wait for the application to
    211            //  start the device.
    212            ZDOInitDevice(0);
    213          #endif
    214          
    215            // Setup for the periodic message's destination address
    216            // Broadcast to everyone
    217            SampleApp_Periodic_DstAddr.addrMode = (afAddrMode_t)AddrBroadcast;
   \   00002E   90....       MOV     DPTR,#SampleApp_Periodic_DstAddr + 8
   \   000031   740F         MOV     A,#0xf
   \   000033   F0           MOVX    @DPTR,A
    218            SampleApp_Periodic_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
   \   000034   A3           INC     DPTR
   \   000035   7414         MOV     A,#0x14
   \   000037   F0           MOVX    @DPTR,A
    219            SampleApp_Periodic_DstAddr.addr.shortAddr = 0xFFFF;
   \   000038   90....       MOV     DPTR,#SampleApp_Periodic_DstAddr
   \   00003B   74FF         MOV     A,#-0x1
   \   00003D   F0           MOVX    @DPTR,A
   \   00003E   A3           INC     DPTR
   \   00003F   F0           MOVX    @DPTR,A
    220          
    221            // Setup for the flash command's destination address - Group 1
    222            SampleApp_Flash_DstAddr.addrMode = (afAddrMode_t)afAddrGroup;
   \   000040   90....       MOV     DPTR,#SampleApp_Flash_DstAddr + 8
   \   000043   7401         MOV     A,#0x1
   \   000045   F0           MOVX    @DPTR,A
    223            SampleApp_Flash_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
   \   000046   A3           INC     DPTR
   \   000047   7414         MOV     A,#0x14
   \   000049   F0           MOVX    @DPTR,A
    224            SampleApp_Flash_DstAddr.addr.shortAddr = SAMPLEAPP_FLASH_GROUP;
   \   00004A   90....       MOV     DPTR,#SampleApp_Flash_DstAddr
   \   00004D   7401         MOV     A,#0x1
   \   00004F   F0           MOVX    @DPTR,A
   \   000050   A3           INC     DPTR
   \   000051   E4           CLR     A
   \   000052   F0           MOVX    @DPTR,A
    225          
    226            // Fill out the endpoint description.
    227            SampleApp_epDesc.endPoint = SAMPLEAPP_ENDPOINT;
   \   000053   90....       MOV     DPTR,#SampleApp_epDesc
   \   000056   7414         MOV     A,#0x14
   \   000058   F0           MOVX    @DPTR,A
    228            SampleApp_epDesc.task_id = &SampleApp_TaskID;
   \   000059   A3           INC     DPTR
   \   00005A   74..         MOV     A,#SampleApp_TaskID & 0xff
   \   00005C   F0           MOVX    @DPTR,A
   \   00005D   A3           INC     DPTR
   \   00005E   74..         MOV     A,#(SampleApp_TaskID >> 8) & 0xff
   \   000060   F0           MOVX    @DPTR,A
    229            SampleApp_epDesc.simpleDesc
    230                      = (SimpleDescriptionFormat_t *)&SampleApp_SimpleDesc;
   \   000061   A3           INC     DPTR
   \   000062   74..         MOV     A,#SampleApp_SimpleDesc & 0xff
   \   000064   F0           MOVX    @DPTR,A
   \   000065   A3           INC     DPTR
   \   000066   74..         MOV     A,#(SampleApp_SimpleDesc >> 8) & 0xff
   \   000068   F0           MOVX    @DPTR,A
    231            SampleApp_epDesc.latencyReq = noLatencyReqs;
   \   000069   A3           INC     DPTR
   \   00006A   E4           CLR     A
   \   00006B   F0           MOVX    @DPTR,A
    232          
    233            // Register the endpoint description with the AF
    234            afRegister( &SampleApp_epDesc );
   \   00006C                ; Setup parameters for call to function afRegister
   \   00006C   7A..         MOV     R2,#SampleApp_epDesc & 0xff
   \   00006E   7B..         MOV     R3,#(SampleApp_epDesc >> 8) & 0xff
   \   000070   12....       LCALL   ??afRegister?relay
    235          
    236            // Register for all key events - This app will handle all key events
    237            RegisterForKeys( SampleApp_TaskID );
   \   000073                ; Setup parameters for call to function RegisterForKeys
   \   000073   90....       MOV     DPTR,#SampleApp_TaskID
   \   000076   E0           MOVX    A,@DPTR
   \   000077   F9           MOV     R1,A
   \   000078   12....       LCALL   ??RegisterForKeys?relay
    238          
    239            // By default, all devices start out in Group 1
    240            SampleApp_Group.ID = 0x0001;
   \   00007B   90....       MOV     DPTR,#SampleApp_Group
   \   00007E   7401         MOV     A,#0x1
   \   000080   F0           MOVX    @DPTR,A
   \   000081   A3           INC     DPTR
   \   000082   E4           CLR     A
   \   000083   F0           MOVX    @DPTR,A
    241            osal_memcpy( SampleApp_Group.name, "Group 1", 7 );
   \   000084                ; Setup parameters for call to function osal_memcpy
   \   000084   75....       MOV     ?V0 + 0,#`?<Constant "Group 1">` & 0xff
   \   000087   75....       MOV     ?V0 + 1,#(`?<Constant "Group 1">` >> 8) & 0xff
   \   00008A   F5..         MOV     ?V0 + 2,A
   \   00008C   78..         MOV     R0,#?V0 + 0
   \   00008E   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000091   7C07         MOV     R4,#0x7
   \   000093   7D00         MOV     R5,#0x0
   \   000095   7A..         MOV     R2,#(SampleApp_Group + 2) & 0xff
   \   000097   7B..         MOV     R3,#((SampleApp_Group + 2) >> 8) & 0xff
   \   000099   12....       LCALL   ??Subroutine4_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   00009C   12....       LCALL   ?DEALLOC_XSTACK8
    242            aps_AddGroup( SAMPLEAPP_ENDPOINT, &SampleApp_Group );
   \   00009F                ; Setup parameters for call to function aps_AddGroup
   \   00009F   7A..         MOV     R2,#SampleApp_Group & 0xff
   \   0000A1   7B..         MOV     R3,#(SampleApp_Group >> 8) & 0xff
   \   0000A3   7914         MOV     R1,#0x14
   \   0000A5   12....       LCALL   ??aps_AddGroup?relay
    243          
    244          #if defined ( LCD_SUPPORTED )
    245            HalLcdWriteString( "SampleApp", HAL_LCD_LINE_1 );
   \   0000A8                ; Setup parameters for call to function HalLcdWriteString
   \   0000A8   7900         MOV     R1,#0x0
   \   0000AA   7A..         MOV     R2,#`?<Constant "SampleApp">` & 0xff
   \   0000AC   7B..         MOV     R3,#(`?<Constant "SampleApp">` >> 8) & 0xff
   \   0000AE   12....       LCALL   ??HalLcdWriteString?relay
    246          #endif
    247          }
   \   0000B1   7F03         MOV     R7,#0x3
   \   0000B3   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   0000B6                REQUIRE P0SEL

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine4_0:
   \   000000   12....       LCALL   ??osal_memcpy?relay
   \   000003   7403         MOV     A,#0x3
   \   000005   22           RET
    248          
    249          /*********************************************************************
    250           * @fn      SampleApp_ProcessEvent
    251           *
    252           * @brief   Generic Application Task event processor.  This function
    253           *          is called to process all events for the task.  Events
    254           *          include timers, messages and any other user defined events.
    255           *
    256           * @param   task_id  - The OSAL assigned task ID.
    257           * @param   events - events to process.  This is a bit map and can
    258           *                   contain more than one event.
    259           *
    260           * @return  none
    261           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    262          uint16 SampleApp_ProcessEvent( uint8 task_id, uint16 events )
   \                     SampleApp_ProcessEvent:
    263          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    264            afIncomingMSGPacket_t *MSGpkt;
    265            (void)task_id;  // Intentionally unreferenced parameter
    266          
    267            if ( events & SYS_EVENT_MSG )
   \   000009   5480         ANL     A,#0x80
   \   00000B   6074         JZ      ??SampleApp_ProcessEvent_0
    268            {
    269              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SampleApp_TaskID );
   \   00000D                ; Setup parameters for call to function osal_msg_receive
   \   00000D   8026         SJMP    ??SampleApp_ProcessEvent_1
    270              while ( MSGpkt )
    271              {
    272                switch ( MSGpkt->hdr.event )
    273                {        
    274                  // Received when a key is pressed
    275                  case KEY_CHANGE:
    276                    SampleApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
    277                    break;
    278          
    279                  // Received when a messages is received (OTA) for this endpoint
    280                  case AF_INCOMING_MSG_CMD:
    281                    SampleApp_MessageMSGCB( MSGpkt );
    282                    break;
    283          
    284                  // Received whenever the device changes state in the network
    285                  case ZDO_STATE_CHANGE:
    286                    SampleApp_NwkState = (devStates_t)(MSGpkt->hdr.status);
   \                     ??SampleApp_ProcessEvent_2:
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   90....       MOV     DPTR,#SampleApp_NwkState
   \   000014   F0           MOVX    @DPTR,A
    287                    if ( //(SampleApp_NwkState == DEV_ZB_COORD) ||
    288                           (SampleApp_NwkState == DEV_ROUTER)
    289                        || (SampleApp_NwkState == DEV_END_DEVICE) )
   \   000015   6407         XRL     A,#0x7
   \   000017   6005         JZ      ??SampleApp_ProcessEvent_3
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   6406         XRL     A,#0x6
   \   00001C   7010         JNZ     ??SampleApp_ProcessEvent_4
    290                    {
    291                      // Start sending the periodic message in a regular interval.
    292                      osal_start_timerEx( SampleApp_TaskID,
    293                                        SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    294                                        SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT );
   \                     ??SampleApp_ProcessEvent_3:
   \   00001E                ; Setup parameters for call to function osal_start_timerEx
   \   00001E   7CB8         MOV     R4,#-0x48
   \   000020   7D0B         MOV     R5,#0xb
   \   000022   7A01         MOV     R2,#0x1
   \   000024   7B00         MOV     R3,#0x0
   \   000026   90....       MOV     DPTR,#SampleApp_TaskID
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F9           MOV     R1,A
   \   00002B   12....       LCALL   ??osal_start_timerEx?relay
    295                    }
    296                    else
    297                    {
    298                      // Device is no longer in the network
    299                    }
    300                    break;
    301          
    302                  default:
    303                    break;
    304                }
    305          
    306                // Release the memory
    307                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??SampleApp_ProcessEvent_4:
   \   00002E                ; Setup parameters for call to function osal_msg_deallocate
   \   00002E   AA..         MOV     R2,?V0 + 0
   \   000030   AB..         MOV     R3,?V0 + 1
   \   000032   12....       LCALL   ??osal_msg_deallocate?relay
    308          
    309                // Next - if one is available
    310                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SampleApp_TaskID );
   \   000035                ; Setup parameters for call to function osal_msg_receive
   \                     ??SampleApp_ProcessEvent_1:
   \   000035   90....       MOV     DPTR,#SampleApp_TaskID
   \   000038   E0           MOVX    A,@DPTR
   \   000039   F9           MOV     R1,A
   \   00003A   12....       LCALL   ??osal_msg_receive?relay
   \   00003D   8A..         MOV     ?V0 + 0,R2
   \   00003F   8B..         MOV     ?V0 + 1,R3
   \   000041   E5..         MOV     A,?V0 + 0
   \   000043   45..         ORL     A,?V0 + 1
   \   000045   6032         JZ      ??SampleApp_ProcessEvent_5
   \   000047   85..82       MOV     DPL,?V0 + 0
   \   00004A   85..83       MOV     DPH,?V0 + 1
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   24E6         ADD     A,#-0x1a
   \   000050   601E         JZ      ??SampleApp_ProcessEvent_6
   \   000052   245A         ADD     A,#0x5a
   \   000054   6006         JZ      ??SampleApp_ProcessEvent_7
   \   000056   24EF         ADD     A,#-0x11
   \   000058   60B5         JZ      ??SampleApp_ProcessEvent_2
   \   00005A   80D2         SJMP    ??SampleApp_ProcessEvent_4
   \                     ??SampleApp_ProcessEvent_7:
   \   00005C                ; Setup parameters for call to function SampleApp_HandleKeys
   \   00005C   A3           INC     DPTR
   \   00005D   A3           INC     DPTR
   \   00005E   A3           INC     DPTR
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   FA           MOV     R2,A
   \   000061   85..82       MOV     DPL,?V0 + 0
   \   000064   85..83       MOV     DPH,?V0 + 1
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F9           MOV     R1,A
   \   00006B   12....       LCALL   ??SampleApp_HandleKeys?relay
   \   00006E   80BE         SJMP    ??SampleApp_ProcessEvent_4
   \                     ??SampleApp_ProcessEvent_6:
   \   000070                ; Setup parameters for call to function SampleApp_MessageMSGCB
   \   000070   AA..         MOV     R2,?V0 + 0
   \   000072   AB..         MOV     R3,?V0 + 1
   \   000074   12....       LCALL   ??SampleApp_MessageMSGCB?relay
   \   000077   80B5         SJMP    ??SampleApp_ProcessEvent_4
    311              }
    312          
    313              // return unprocessed events
    314              return (events ^ SYS_EVENT_MSG);
   \                     ??SampleApp_ProcessEvent_5:
   \   000079   EE           MOV     A,R6
   \   00007A   FA           MOV     R2,A
   \   00007B   EF           MOV     A,R7
   \   00007C   6480         XRL     A,#0x80
   \                     ??SampleApp_ProcessEvent_8:
   \   00007E   FB           MOV     R3,A
   \   00007F   802A         SJMP    ??SampleApp_ProcessEvent_9
    315            }
    316          
    317            // Send a message out - This event is generated by a timer
    318            //  (setup in SampleApp_Init()).
    319            if ( events & SAMPLEAPP_SEND_PERIODIC_MSG_EVT )
   \                     ??SampleApp_ProcessEvent_0:
   \   000081   EE           MOV     A,R6
   \   000082   A2E0         MOV     C,0xE0 /* A   */.0
   \   000084   5021         JNC     ??SampleApp_ProcessEvent_10
    320            {
    321              // Send the periodic message
    322              SampleApp_SendPeriodicMessage();
   \   000086                ; Setup parameters for call to function SampleApp_SendPeriodicMessage
   \   000086   12....       LCALL   ??SampleApp_SendPeriodicMessage?relay
    323          
    324              // Setup to send message again in normal period (+ a little jitter)
    325              osal_start_timerEx( SampleApp_TaskID, SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    326                  (SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT + (osal_rand() & 0x00FF)) );
   \   000089                ; Setup parameters for call to function osal_rand
   \   000089   12....       LCALL   ??osal_rand?relay
   \   00008C                ; Setup parameters for call to function osal_start_timerEx
   \   00008C   EA           MOV     A,R2
   \   00008D   24B8         ADD     A,#-0x48
   \   00008F   FC           MOV     R4,A
   \   000090   E4           CLR     A
   \   000091   340B         ADDC    A,#0xb
   \   000093   FD           MOV     R5,A
   \   000094   7A01         MOV     R2,#0x1
   \   000096   7B00         MOV     R3,#0x0
   \   000098   90....       MOV     DPTR,#SampleApp_TaskID
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   F9           MOV     R1,A
   \   00009D   12....       LCALL   ??osal_start_timerEx?relay
    327          
    328              // return unprocessed events
    329              return (events ^ SAMPLEAPP_SEND_PERIODIC_MSG_EVT);
   \   0000A0   EE           MOV     A,R6
   \   0000A1   6401         XRL     A,#0x1
   \   0000A3   FA           MOV     R2,A
   \   0000A4   EF           MOV     A,R7
   \   0000A5   80D7         SJMP    ??SampleApp_ProcessEvent_8
    330            }
    331          
    332            // Discard unknown events
    333            return 0;
   \                     ??SampleApp_ProcessEvent_10:
   \   0000A7   7A00         MOV     R2,#0x0
   \   0000A9   7B00         MOV     R3,#0x0
   \                     ??SampleApp_ProcessEvent_9:
   \   0000AB                REQUIRE ?Subroutine0
   \   0000AB                ; // Fall through to label ?Subroutine0
    334          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    335          
    336          /*********************************************************************
    337           * Event Generation Functions
    338           */
    339          /*********************************************************************
    340           * @fn      SampleApp_HandleKeys
    341           *
    342           * @brief   Handles all key events for this device.
    343           *
    344           * @param   shift - true if in shift/alt.
    345           * @param   keys - bit field for key events. Valid entries:
    346           *                 HAL_KEY_SW_2
    347           *                 HAL_KEY_SW_1
    348           *
    349           * @return  none
    350           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    351          void SampleApp_HandleKeys( uint8 shift, uint8 keys )
   \                     SampleApp_HandleKeys:
    352          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
    353            (void)shift;  // Intentionally unreferenced parameter
    354            
    355            if ( keys & HAL_KEY_SW_1 )
   \   000007   A2E0         MOV     C,0xE0 /* A   */.0
   \   000009   5007         JNC     ??SampleApp_HandleKeys_0
    356            {
    357              /* This key sends the Flash Command is sent to Group 1.
    358               * This device will not receive the Flash Command from this
    359               * device (even if it belongs to group 1).
    360               */
    361              SampleApp_SendFlashMessage( SAMPLEAPP_FLASH_DURATION );
   \   00000B                ; Setup parameters for call to function SampleApp_SendFlashMessage
   \   00000B   7AE8         MOV     R2,#-0x18
   \   00000D   7B03         MOV     R3,#0x3
   \   00000F   12....       LCALL   ??SampleApp_SendFlashMessage?relay
    362            }
    363          
    364            if ( keys & HAL_KEY_SW_2 )
   \                     ??SampleApp_HandleKeys_0:
   \   000012   EE           MOV     A,R6
   \   000013   A2E1         MOV     C,0xE0 /* A   */.1
   \   000015   5024         JNC     ??SampleApp_HandleKeys_1
    365            {
    366              /* The Flashr Command is sent to Group 1.
    367               * This key toggles this device in and out of group 1.
    368               * If this device doesn't belong to group 1, this application
    369               * will not receive the Flash command sent to group 1.
    370               */
    371              aps_Group_t *grp;
    372              grp = aps_FindGroup( SAMPLEAPP_ENDPOINT, SAMPLEAPP_FLASH_GROUP );
    373              if ( grp )
   \   000017                ; Setup parameters for call to function aps_FindGroup
   \   000017   7A01         MOV     R2,#0x1
   \   000019   7B00         MOV     R3,#0x0
   \   00001B   7914         MOV     R1,#0x14
   \   00001D   12....       LCALL   ??aps_FindGroup?relay
   \   000020   8B..         MOV     ?V0 + 1,R3
   \   000022   EA           MOV     A,R2
   \   000023   45..         ORL     A,?V0 + 1
   \   000025   600B         JZ      ??SampleApp_HandleKeys_2
    374              {
    375                // Remove from the group
    376                aps_RemoveGroup( SAMPLEAPP_ENDPOINT, SAMPLEAPP_FLASH_GROUP );
   \   000027                ; Setup parameters for call to function aps_RemoveGroup
   \   000027   7A01         MOV     R2,#0x1
   \   000029   7B00         MOV     R3,#0x0
   \   00002B   7914         MOV     R1,#0x14
   \   00002D   12....       LCALL   ??aps_RemoveGroup?relay
   \   000030   8009         SJMP    ??SampleApp_HandleKeys_1
    377              }
    378              else
    379              {
    380                // Add to the flash group
    381                aps_AddGroup( SAMPLEAPP_ENDPOINT, &SampleApp_Group );
   \                     ??SampleApp_HandleKeys_2:
   \   000032                ; Setup parameters for call to function aps_AddGroup
   \   000032   7A..         MOV     R2,#SampleApp_Group & 0xff
   \   000034   7B..         MOV     R3,#(SampleApp_Group >> 8) & 0xff
   \   000036   7914         MOV     R1,#0x14
   \   000038   12....       LCALL   ??aps_AddGroup?relay
    382              }
    383            }
    384          }
   \                     ??SampleApp_HandleKeys_1:
   \   00003B                REQUIRE ?Subroutine1
   \   00003B                ; // Fall through to label ?Subroutine1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    385          
    386          /*********************************************************************
    387           * LOCAL FUNCTIONS
    388           */
    389          
    390          /*********************************************************************
    391           * @fn      SampleApp_MessageMSGCB
    392           *
    393           * @brief   Data message processor callback.  This function processes
    394           *          any incoming data - probably from other devices.  So, based
    395           *          on cluster ID, perform the intended action.
    396           *
    397           * @param   none
    398           *
    399           * @return  none
    400           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    401          void SampleApp_MessageMSGCB( afIncomingMSGPacket_t *pkt ) //接收数据
   \                     SampleApp_MessageMSGCB:
    402          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    403            uint16 flashTime;
    404          
    405            switch ( pkt->clusterId )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F5..         MOV     ?V0 + 0,A
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   F5..         MOV     ?V0 + 1,A
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?US_SWITCH_DENSE
   \                     `?<Jumptable for SampleApp_MessageMSGCB>_0`:
   \   00001D   0100         DW        1
   \   00001F   01           DB        1
   \   000020   ....         DW        ??SampleApp_MessageMSGCB_0
   \   000022   ....         DW        ??SampleApp_MessageMSGCB_1
   \   000024   ....         DW        ??SampleApp_MessageMSGCB_2
    406            {
    407              case SAMPLEAPP_PERIODIC_CLUSTERID:
    408                HalUARTWrite(0, "Rx:", 3);        //提示信息
   \                     ??SampleApp_MessageMSGCB_1:
   \   000026                ; Setup parameters for call to function HalUARTWrite
   \   000026   7C03         MOV     R4,#0x3
   \   000028   7D00         MOV     R5,#0x0
   \   00002A   7A..         MOV     R2,#`?<Constant "Rx:">` & 0xff
   \   00002C   7B..         MOV     R3,#(`?<Constant "Rx:">` >> 8) & 0xff
   \   00002E   7900         MOV     R1,#0x0
   \   000030   12....       LCALL   ??HalUARTWrite?relay
    409                HalUARTWrite(0, pkt->cmd.Data, pkt->cmd.DataLength); //输出接收到的数据
   \   000033                ; Setup parameters for call to function HalUARTWrite
   \   000033   EE           MOV     A,R6
   \   000034   2420         ADD     A,#0x20
   \   000036   F582         MOV     DPL,A
   \   000038   EF           MOV     A,R7
   \   000039   3400         ADDC    A,#0x0
   \   00003B   F583         MOV     DPH,A
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   FC           MOV     R4,A
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   FD           MOV     R5,A
   \   000042   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   000045   FA           MOV     R2,A
   \   000046   A3           INC     DPTR
   \   000047   E0           MOVX    A,@DPTR
   \   000048   FB           MOV     R3,A
   \   000049   7900         MOV     R1,#0x0
   \   00004B   12....       LCALL   ??HalUARTWrite?relay
    410                HalUARTWrite(0, "\n", 1);         //回车换行
   \   00004E                ; Setup parameters for call to function HalUARTWrite
   \   00004E   7C01         MOV     R4,#0x1
   \   000050   7D00         MOV     R5,#0x0
   \   000052   7A..         MOV     R2,#`?<Constant "\\n">` & 0xff
   \   000054   7B..         MOV     R3,#(`?<Constant "\\n">` >> 8) & 0xff
   \   000056   7900         MOV     R1,#0x0
   \   000058   12....       LCALL   ??HalUARTWrite?relay
    411                break;
   \   00005B   8033         SJMP    ??SampleApp_MessageMSGCB_0
   \                     ??SampleApp_MessageMSGCB_2:
   \   00005D   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   000060   F8           MOV     R0,A
   \   000061   A3           INC     DPTR
   \   000062   E0           MOVX    A,@DPTR
   \   000063   F9           MOV     R1,A
   \   000064                ; Setup parameters for call to function HalLedBlink
   \   000064   8882         MOV     DPL,R0
   \   000066   8983         MOV     DPH,R1
   \   000068   A3           INC     DPTR
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   FA           MOV     R2,A
   \   00006B   8882         MOV     DPL,R0
   \   00006D   8983         MOV     DPH,R1
   \   00006F   A3           INC     DPTR
   \   000070   A3           INC     DPTR
   \   000071   E0           MOVX    A,@DPTR
   \   000072   F9           MOV     R1,A
   \   000073   EA           MOV     A,R2
   \   000074   2400         ADD     A,#0x0
   \   000076   F5..         MOV     ?V0 + 0,A
   \   000078   E4           CLR     A
   \   000079   39           ADDC    A,R1
   \   00007A   F5..         MOV     ?V0 + 1,A
   \   00007C   7402         MOV     A,#0x2
   \   00007E   78..         MOV     R0,#?V0 + 0
   \   000080   12....       LCALL   ?US_SHR
   \   000083   AC..         MOV     R4,?V0 + 0
   \   000085   AD..         MOV     R5,?V0 + 1
   \   000087   7B32         MOV     R3,#0x32
   \   000089   7A04         MOV     R2,#0x4
   \   00008B   7908         MOV     R1,#0x8
    412          
    413              case SAMPLEAPP_FLASH_CLUSTERID:     //此实验没有使用，到后面实验详解
    414                flashTime = BUILD_UINT16(pkt->cmd.Data[1], pkt->cmd.Data[2] );
    415                HalLedBlink( HAL_LED_4, 4, 50, (flashTime / 4) );
   \   00008D   12....       LCALL   ??HalLedBlink?relay
    416                break;
    417            }
    418          }
   \                     ??SampleApp_MessageMSGCB_0:
   \   000090   02....       LJMP    ?Subroutine1 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   EE           MOV     A,R6
   \   000001   2422         ADD     A,#0x22
   \   000003   F582         MOV     DPL,A
   \   000005   EF           MOV     A,R7
   \   000006   3400         ADDC    A,#0x0
   \   000008   F583         MOV     DPH,A
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   22           RET
    419          
    420          /*********************************************************************
    421           * @fn      SampleApp_SendPeriodicMessage
    422           *
    423           * @brief   Send the periodic message.
    424           *
    425           * @param   none
    426           *
    427           * @return  none
    428           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    429          void SampleApp_SendPeriodicMessage( void )
   \                     SampleApp_SendPeriodicMessage:
    430          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 40
   \   000005   74D8         MOV     A,#-0x28
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    431            unsigned char data[20];
    432            unsigned char temp[3], humidity[3], strTemp[9];
    433            
    434            unsigned int pmval = 0;
    435            unsigned char pmval_s[5] = {'\0'}; //长度不小于5
   \   00000A   740F         MOV     A,#0xf
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   AC82         MOV     R4,DPL
   \   000011   AD83         MOV     R5,DPH
   \   000013   7583..       MOV     DPH,#(`?<Constant {0}>` >> 8) & 0xff
   \   000016   7582..       MOV     DPL,#`?<Constant {0}>` & 0xff
   \   000019   7405         MOV     A,#0x5
   \   00001B   12....       LCALL   ?MOVE_LONG8_XDATA_XDATA
    436            unsigned char pmval_s_len = 0; //转换成字符串后有效长度
   \   00001E   FE           MOV     R6,A
    437            //-----------------------------------------------
    438          //set_32MHZ();
    439           // uart_init(SYS_CLOCK_32MHZ , UART_BAUD_9600);
    440            sensor_init();  //初始化传感器相关;
   \   00001F                ; Setup parameters for call to function sensor_init
   \   00001F   12....       LCALL   ??sensor_init?relay
    441          
    442            pmval = sennor_getpmval();
   \   000022                ; Setup parameters for call to function sennor_getpmval
   \   000022   12....       LCALL   ??sennor_getpmval?relay
   \   000025   8A..         MOV     ?V0 + 0,R2
   \   000027   8B..         MOV     ?V0 + 1,R3
    443           
    444             if(pmval > 38)
   \   000029   C3           CLR     C
   \   00002A   EA           MOV     A,R2
   \   00002B   9427         SUBB    A,#0x27
   \   00002D   EB           MOV     A,R3
   \   00002E   9400         SUBB    A,#0x0
   \   000030   401F         JC      ??SampleApp_SendPeriodicMessage_0
    445             {
    446                 pmval <<= 2;
    447                 pmval -= 150;         
    448                 pmval_s_len = uint16_to_str(pmval_s , pmval);   
   \   000032                ; Setup parameters for call to function uint16_to_str
   \   000032   7402         MOV     A,#0x2
   \   000034   78..         MOV     R0,#?V0 + 0
   \   000036   12....       LCALL   ?S_SHL
   \   000039   E5..         MOV     A,?V0 + 0
   \   00003B   246A         ADD     A,#0x6a
   \   00003D   FC           MOV     R4,A
   \   00003E   E5..         MOV     A,?V0 + 1
   \   000040   34FF         ADDC    A,#-0x1
   \   000042   FD           MOV     R5,A
   \   000043   740F         MOV     A,#0xf
   \   000045   12....       LCALL   ?XSTACK_DISP0_8
   \   000048   AA82         MOV     R2,DPL
   \   00004A   AB83         MOV     R3,DPH
   \   00004C   12....       LCALL   ??uint16_to_str?relay
   \   00004F   E9           MOV     A,R1
   \   000050   FE           MOV     R6,A
    449             }
    450             
    451           //  uart_sendstring(pmval_s , pmval_s_len);
    452           //  uart_sendstring("\r\n" ,2);
    453             
    454          //------------------------------------------------
    455            DHT11();             //获取温湿度
   \                     ??SampleApp_SendPeriodicMessage_0:
   \   000051                ; Setup parameters for call to function DHT11
   \   000051   12....       LCALL   ??DHT11?relay
    456          
    457            //将温湿度的转换成字符串,供LCD显示  
    458            temp[0] = wendu_shi+0x30;
   \   000054   90....       MOV     DPTR,#wendu_shi
   \   000057   E0           MOVX    A,@DPTR
   \   000058   2430         ADD     A,#0x30
   \   00005A   C0E0         PUSH    A
   \   00005C   7403         MOV     A,#0x3
   \   00005E   12....       LCALL   ?XSTACK_DISP0_8
   \   000061   D0E0         POP     A
   \   000063   F0           MOVX    @DPTR,A
    459            temp[1] = wendu_ge+0x30;
   \   000064   90....       MOV     DPTR,#wendu_ge
   \   000067   E0           MOVX    A,@DPTR
   \   000068   2430         ADD     A,#0x30
   \   00006A   C0E0         PUSH    A
   \   00006C   7404         MOV     A,#0x4
   \   00006E   12....       LCALL   ?XSTACK_DISP0_8
   \   000071   D0E0         POP     A
   \   000073   F0           MOVX    @DPTR,A
    460            temp[2] = '\0';
   \   000074   7405         MOV     A,#0x5
   \   000076   12....       LCALL   ?XSTACK_DISP0_8
   \   000079   E4           CLR     A
   \   00007A   F0           MOVX    @DPTR,A
    461            humidity[0] = shidu_shi+0x30;
   \   00007B   90....       MOV     DPTR,#shidu_shi
   \   00007E   E0           MOVX    A,@DPTR
   \   00007F   2430         ADD     A,#0x30
   \   000081   85..82       MOV     DPL,?XSP + 0
   \   000084   85..83       MOV     DPH,?XSP + 1
   \   000087   F0           MOVX    @DPTR,A
    462            humidity[1] = shidu_ge+0x30;
   \   000088   90....       MOV     DPTR,#shidu_ge
   \   00008B   E0           MOVX    A,@DPTR
   \   00008C   2430         ADD     A,#0x30
   \   00008E   C0E0         PUSH    A
   \   000090   7401         MOV     A,#0x1
   \   000092   12....       LCALL   ?XSTACK_DISP0_8
   \   000095   D0E0         POP     A
   \   000097   F0           MOVX    @DPTR,A
    463            humidity[2] = '\0';
   \   000098   7402         MOV     A,#0x2
   \   00009A   12....       LCALL   ?XSTACK_DISP0_8
   \   00009D   E4           CLR     A
   \   00009E   F0           MOVX    @DPTR,A
    464            //将数据整合后方便发给协调器显示
    465            osal_memcpy(strTemp, "T", 1);
   \   00009F                ; Setup parameters for call to function osal_memcpy
   \   00009F   75....       MOV     ?V0 + 0,#`?<Constant "T">` & 0xff
   \   0000A2   75....       MOV     ?V0 + 1,#(`?<Constant "T">` >> 8) & 0xff
   \   0000A5   F5..         MOV     ?V0 + 2,A
   \   0000A7   78..         MOV     R0,#?V0 + 0
   \   0000A9   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000AC   7C01         MOV     R4,#0x1
   \   0000AE   7D00         MOV     R5,#0x0
   \   0000B0   7409         MOV     A,#0x9
   \   0000B2   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B5   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   0000B8   12....       LCALL   ?DEALLOC_XSTACK8
    466            osal_memcpy(&strTemp[1], temp, 2); 
   \   0000BB                ; Setup parameters for call to function osal_memcpy
   \   0000BB   7403         MOV     A,#0x3
   \   0000BD   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C0   A982         MOV     R1,DPL
   \   0000C2   AA83         MOV     R2,DPH
   \   0000C4   89..         MOV     ?V0 + 0,R1
   \   0000C6   8A..         MOV     ?V0 + 1,R2
   \   0000C8   78..         MOV     R0,#?V0 + 0
   \   0000CA   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000CD   7C02         MOV     R4,#0x2
   \   0000CF   7D00         MOV     R5,#0x0
   \   0000D1   740A         MOV     A,#0xa
   \   0000D3   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D6   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   0000D9   12....       LCALL   ?DEALLOC_XSTACK8
    467            osal_memcpy(&strTemp[3], " H", 2);
   \   0000DC                ; Setup parameters for call to function osal_memcpy
   \   0000DC   75....       MOV     ?V0 + 0,#`?<Constant " H">` & 0xff
   \   0000DF   75....       MOV     ?V0 + 1,#(`?<Constant " H">` >> 8) & 0xff
   \   0000E2   78..         MOV     R0,#?V0 + 0
   \   0000E4   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000E7   7C02         MOV     R4,#0x2
   \   0000E9   7D00         MOV     R5,#0x0
   \   0000EB   740C         MOV     A,#0xc
   \   0000ED   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F0   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_4:
   \   0000F3   12....       LCALL   ?DEALLOC_XSTACK8
    468            osal_memcpy(&strTemp[5], humidity, 3);
   \   0000F6                ; Setup parameters for call to function osal_memcpy
   \   0000F6   85..82       MOV     DPL,?XSP + 0
   \   0000F9   85..83       MOV     DPH,?XSP + 1
   \   0000FC   A982         MOV     R1,DPL
   \   0000FE   AA83         MOV     R2,DPH
   \   000100   89..         MOV     ?V0 + 0,R1
   \   000102   8A..         MOV     ?V0 + 1,R2
   \   000104   78..         MOV     R0,#?V0 + 0
   \   000106   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000109   7C03         MOV     R4,#0x3
   \   00010B   7D00         MOV     R5,#0x0
   \   00010D   740E         MOV     A,#0xe
   \   00010F   12....       LCALL   ?XSTACK_DISP0_8
   \   000112   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   000115   12....       LCALL   ?DEALLOC_XSTACK8
    469            
    470            
    471            
    472           /*
    473            osal_memcpy(strTemp, temp, 2); 
    474            osal_memcpy(&strTemp[2], " ", 1);
    475            osal_memcpy(&strTemp[3], humidity, 3);
    476           */
    477           /*
    478            osal_memcpy(data, strTemp, 5); 
    479            osal_memcpy(&data[5], " ", 1); 
    480            osal_memcpy(&data[6], pmval_s, pmval_s_len); 
    481            */
    482            osal_memcpy(data, strTemp, 7); 
   \   000118                ; Setup parameters for call to function osal_memcpy
   \   000118   7406         MOV     A,#0x6
   \   00011A   12....       LCALL   ?XSTACK_DISP0_8
   \   00011D   A982         MOV     R1,DPL
   \   00011F   AA83         MOV     R2,DPH
   \   000121   89..         MOV     ?V0 + 0,R1
   \   000123   8A..         MOV     ?V0 + 1,R2
   \   000125   78..         MOV     R0,#?V0 + 0
   \   000127   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00012A   7C07         MOV     R4,#0x7
   \   00012C   7D00         MOV     R5,#0x0
   \   00012E   7417         MOV     A,#0x17
   \   000130   12....       LCALL   ?XSTACK_DISP0_8
   \   000133   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   000136   12....       LCALL   ?DEALLOC_XSTACK8
    483            osal_memcpy(&data[7], " P", 2); 
   \   000139                ; Setup parameters for call to function osal_memcpy
   \   000139   75....       MOV     ?V0 + 0,#`?<Constant " P">` & 0xff
   \   00013C   75....       MOV     ?V0 + 1,#(`?<Constant " P">` >> 8) & 0xff
   \   00013F   78..         MOV     R0,#?V0 + 0
   \   000141   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000144   7C02         MOV     R4,#0x2
   \   000146   7D00         MOV     R5,#0x0
   \   000148   741E         MOV     A,#0x1e
   \   00014A   12....       LCALL   ?XSTACK_DISP0_8
   \   00014D   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   000150   12....       LCALL   ?DEALLOC_XSTACK8
    484            osal_memcpy(&data[9], pmval_s, pmval_s_len); 
   \   000153                ; Setup parameters for call to function osal_memcpy
   \   000153   740F         MOV     A,#0xf
   \   000155   12....       LCALL   ?XSTACK_DISP0_8
   \   000158   A982         MOV     R1,DPL
   \   00015A   AA83         MOV     R2,DPH
   \   00015C   89..         MOV     ?V0 + 0,R1
   \   00015E   8A..         MOV     ?V0 + 1,R2
   \   000160   78..         MOV     R0,#?V0 + 0
   \   000162   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000165   8E..         MOV     ?V0 + 0,R6
   \   000167   AC..         MOV     R4,?V0 + 0
   \   000169   7D00         MOV     R5,#0x0
   \   00016B   7420         MOV     A,#0x20
   \   00016D   12....       LCALL   ?XSTACK_DISP0_8
   \   000170   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_8:
   \   000173   12....       LCALL   ?DEALLOC_XSTACK8
    485            data[10+pmval_s_len] = 'E';
   \   000176   8E82         MOV     DPL,R6
   \   000178   AA82         MOV     R2,DPL
   \   00017A   7414         MOV     A,#0x14
   \   00017C   12....       LCALL   ?XSTACK_DISP0_8
   \   00017F   E582         MOV     A,DPL
   \   000181   2A           ADD     A,R2
   \   000182   F582         MOV     DPL,A
   \   000184   E583         MOV     A,DPH
   \   000186   3400         ADDC    A,#0x0
   \   000188   F583         MOV     DPH,A
   \   00018A   A3           INC     DPTR
   \   00018B   A3           INC     DPTR
   \   00018C   A3           INC     DPTR
   \   00018D   A3           INC     DPTR
   \   00018E   A3           INC     DPTR
   \   00018F   A3           INC     DPTR
   \   000190   A3           INC     DPTR
   \   000191   A3           INC     DPTR
   \   000192   A3           INC     DPTR
   \   000193   A3           INC     DPTR
   \   000194   7445         MOV     A,#0x45
   \   000196   F0           MOVX    @DPTR,A
    486            
    487            
    488            if ( AF_DataRequest( &SampleApp_Periodic_DstAddr, &SampleApp_epDesc,
    489                                 SAMPLEAPP_PERIODIC_CLUSTERID,
    490                                 10+pmval_s_len,
    491                                 (uint8 *)data,
    492                                 &SampleApp_TransID,
    493                                 AF_DISCV_ROUTE,
    494                                 AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   000197                ; Setup parameters for call to function AF_DataRequest
   \   000197   75..1E       MOV     ?V0 + 0,#0x1e
   \   00019A   78..         MOV     R0,#?V0 + 0
   \   00019C   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00019F   75....       MOV     ?V0 + 0,#SampleApp_TransID & 0xff
   \   0001A2   75....       MOV     ?V0 + 1,#(SampleApp_TransID >> 8) & 0xff
   \   0001A5   78..         MOV     R0,#?V0 + 0
   \   0001A7   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001AA   7417         MOV     A,#0x17
   \   0001AC   12....       LCALL   ?XSTACK_DISP0_8
   \   0001AF   8582..       MOV     ?V0 + 0,DPL
   \   0001B2   8583..       MOV     ?V0 + 1,DPH
   \   0001B5   78..         MOV     R0,#?V0 + 0
   \   0001B7   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001BA   EA           MOV     A,R2
   \   0001BB   240A         ADD     A,#0xa
   \   0001BD   F5..         MOV     ?V0 + 0,A
   \   0001BF   E4           CLR     A
   \   0001C0   3400         ADDC    A,#0x0
   \   0001C2   F5..         MOV     ?V0 + 1,A
   \   0001C4   78..         MOV     R0,#?V0 + 0
   \   0001C6   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001C9   75..01       MOV     ?V0 + 0,#0x1
   \   0001CC   75..00       MOV     ?V0 + 1,#0x0
   \   0001CF   78..         MOV     R0,#?V0 + 0
   \   0001D1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001D4   7920         MOV     R1,#0x20
   \   0001D6   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   0001D8   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   0001DA   7A..         MOV     R2,#SampleApp_Periodic_DstAddr & 0xff
   \   0001DC   7B..         MOV     R3,#(SampleApp_Periodic_DstAddr >> 8) & 0xff
   \   0001DE   12....       LCALL   ??AF_DataRequest?relay
   \   0001E1   7409         MOV     A,#0x9
   \   0001E3   12....       LCALL   ?DEALLOC_XSTACK8
    495            {
    496            }
    497            else
    498            {
    499              // Error occurred in request to send.
    500            }
    501          }
   \   0001E6   7428         MOV     A,#0x28
   \   0001E8   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001EB   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   AA82         MOV     R2,DPL
   \   000002   AB83         MOV     R3,DPH
   \   000004                REQUIRE ??Subroutine4_0
   \   000004                ; // Fall through to label ??Subroutine4_0
    502          
    503          /*********************************************************************
    504           * @fn      SampleApp_SendFlashMessage
    505           *
    506           * @brief   Send the flash message to group 1.
    507           *
    508           * @param   flashTime - in milliseconds
    509           *
    510           * @return  none
    511           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    512          void SampleApp_SendFlashMessage( uint16 flashTime )
   \                     SampleApp_SendFlashMessage:
    513          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    514            uint8 buffer[3];
    515            buffer[0] = (uint8)(SampleAppFlashCounter++);
   \   00000A   90....       MOV     DPTR,#SampleAppFlashCounter
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   F0           MOVX    @DPTR,A
   \   000015   90....       MOV     DPTR,#SampleAppFlashCounter
   \   000018   E0           MOVX    A,@DPTR
   \   000019   04           INC     A
   \   00001A   F0           MOVX    @DPTR,A
    516            buffer[1] = LO_UINT16( flashTime );
   \   00001B   7401         MOV     A,#0x1
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   EA           MOV     A,R2
   \   000021   F0           MOVX    @DPTR,A
    517            buffer[2] = HI_UINT16( flashTime );
   \   000022   7402         MOV     A,#0x2
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   EB           MOV     A,R3
   \   000028   F0           MOVX    @DPTR,A
    518          
    519            if ( AF_DataRequest( &SampleApp_Flash_DstAddr, &SampleApp_epDesc,
    520                                 SAMPLEAPP_FLASH_CLUSTERID,
    521                                 3,
    522                                 buffer,
    523                                 &SampleApp_TransID,
    524                                 AF_DISCV_ROUTE,
    525                                 AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   000029                ; Setup parameters for call to function AF_DataRequest
   \   000029   75..1E       MOV     ?V0 + 0,#0x1e
   \   00002C   78..         MOV     R0,#?V0 + 0
   \   00002E   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000031   75....       MOV     ?V0 + 0,#SampleApp_TransID & 0xff
   \   000034   75....       MOV     ?V0 + 1,#(SampleApp_TransID >> 8) & 0xff
   \   000037   78..         MOV     R0,#?V0 + 0
   \   000039   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003C   7403         MOV     A,#0x3
   \   00003E   12....       LCALL   ?XSTACK_DISP0_8
   \   000041   8582..       MOV     ?V0 + 0,DPL
   \   000044   8583..       MOV     ?V0 + 1,DPH
   \   000047   78..         MOV     R0,#?V0 + 0
   \   000049   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00004C   75..03       MOV     ?V0 + 0,#0x3
   \   00004F   75..00       MOV     ?V0 + 1,#0x0
   \   000052   78..         MOV     R0,#?V0 + 0
   \   000054   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000057   75..02       MOV     ?V0 + 0,#0x2
   \   00005A   78..         MOV     R0,#?V0 + 0
   \   00005C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00005F   7920         MOV     R1,#0x20
   \   000061   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   000063   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   000065   7A..         MOV     R2,#SampleApp_Flash_DstAddr & 0xff
   \   000067   7B..         MOV     R3,#(SampleApp_Flash_DstAddr >> 8) & 0xff
   \   000069   12....       LCALL   ??AF_DataRequest?relay
   \   00006C   7409         MOV     A,#0x9
   \   00006E   12....       LCALL   ?DEALLOC_XSTACK8
    526            {
    527            }
    528            else
    529            {
    530              // Error occurred in request to send.
    531            }
    532          }
   \   000071   7403         MOV     A,#0x3
   \   000073   12....       LCALL   ?DEALLOC_XSTACK8
   \   000076   02....       LJMP    ?Subroutine1 & 0xFFFF

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for AppTitle>`:
   \   000000   414C4420     DB "ALD Broadcast"
   \            42726F61
   \            64636173
   \            7400    

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_HandleKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_MessageMSGCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_MessageMSGCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_SendPeriodicMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_SendPeriodicMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_SendFlashMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_SendFlashMessage

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "UartInit OK\\n">`:
   \   000000   55617274     DB "UartInit OK\012"
   \            496E6974
   \            204F4B0A
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Group 1">`:
   \   000000   47726F75     DB "Group 1"
   \            70203100

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "SampleApp">`:
   \   000000   53616D70     DB "SampleApp"
   \            6C654170
   \            7000    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Rx:">`:
   \   000000   52783A00     DB "Rx:"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "\\n">`:
   \   000000   0A00         DB "\012"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {0}>`:
   \   000000   00           DB 0
   \   000001   00000000     DB 0, 0, 0, 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "T">`:
   \   000000   5400         DB "T"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant " H">`:
   \   000000   204800       DB " H"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant " P">`:
   \   000000   205000       DB " P"
    533          /*********************************************************************
    534          *********************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     SampleApp_HandleKeys               0      0     22
       -> SampleApp_SendFlashMessage
                                        0      0     20
       -> aps_FindGroup                 0      0     20
       -> aps_RemoveGroup               0      0     20
       -> aps_AddGroup                  0      0     20
     SampleApp_Init                     0      0     14
       -> MT_UartInit                   0      0     22
       -> MT_UartRegisterTaskID         0      0     22
       -> HalUARTWrite                  0      0     22
       -> afRegister                    0      0     22
       -> RegisterForKeys               0      0     22
       -> osal_memcpy                   0      0     28
       -> aps_AddGroup                  0      0     22
       -> HalLcdWriteString             0      0     22
     SampleApp_MessageMSGCB             0      0     22
       -> HalUARTWrite                  0      0     20
       -> HalUARTWrite                  0      0     20
       -> HalUARTWrite                  0      0     20
       -> HalLedBlink                   0      0     20
     SampleApp_ProcessEvent             0      0     12
       -> osal_msg_receive              0      0     24
       -> osal_start_timerEx            0      0     24
       -> osal_msg_deallocate           0      0     24
       -> osal_msg_receive              0      0     24
       -> SampleApp_HandleKeys          0      0     24
       -> SampleApp_MessageMSGCB        0      0     24
       -> SampleApp_SendPeriodicMessage
                                        0      0     24
       -> osal_rand                     0      0     24
       -> osal_start_timerEx            0      0     24
     SampleApp_SendFlashMessage         1      0     32
       -> AF_DataRequest                0      0     44
     SampleApp_SendPeriodicMessage      2      0     73
       -> sensor_init                   0      0    104
       -> sennor_getpmval               0      0    104
       -> uint16_to_str                 0      0    104
       -> DHT11                         0      0    104
       -> osal_memcpy                   0      0    110
       -> osal_memcpy                   0      0    110
       -> osal_memcpy                   0      0    110
       -> osal_memcpy                   0      0    110
       -> osal_memcpy                   0      0    110
       -> osal_memcpy                   0      0    110
       -> osal_memcpy                   0      0    110
       -> AF_DataRequest                0      0    122


   Segment part sizes:

     Function/Label                        Bytes
     --------------                        -----
     P0SEL                                    1
     AppTitle                                14
     SampleApp_ClusterList                    4
     SampleApp_SimpleDesc                    12
     SampleApp_epDesc                         6
     SampleApp_TaskID                         1
     SampleApp_NwkState                       1
     SampleApp_TransID                        1
     SampleApp_Periodic_DstAddr              12
     SampleApp_Flash_DstAddr                 12
     SampleApp_Group                         18
     SampleAppPeriodicCounter                 1
     SampleAppFlashCounter                    1
     SampleApp_Init                         182
     ??Subroutine4_0                          6
     SampleApp_ProcessEvent                 171
     ?Subroutine0                             5
     SampleApp_HandleKeys                    59
     ?Subroutine1                             5
     SampleApp_MessageMSGCB                 147
     ?Subroutine3                            12
     SampleApp_SendPeriodicMessage          494
     ?Subroutine2                             4
     SampleApp_SendFlashMessage             121
     ?<Initializer for AppTitle>             14
     ??SampleApp_Init?relay                   6
     ??SampleApp_ProcessEvent?relay           6
     ??SampleApp_HandleKeys?relay             6
     ??SampleApp_MessageMSGCB?relay           6
     ??SampleApp_SendPeriodicMessage?relay    6
     ??SampleApp_SendFlashMessage?relay       6
     ?<Constant "UartInit OK\n">             13
     ?<Constant "Group 1">                    8
     ?<Constant "SampleApp">                 10
     ?<Constant "Rx:">                        4
     ?<Constant "\n">                         2
     ?<Constant {0}>                          5
     ?<Constant "T">                          2
     ?<Constant " H">                         3
     ?<Constant " P">                         3

 
 1 206 bytes in segment BANKED_CODE
    36 bytes in segment BANK_RELAYS
     1 byte  in segment SFR_AN
    14 bytes in segment XDATA_I
    14 bytes in segment XDATA_ID
    66 bytes in segment XDATA_ROM_C
    53 bytes in segment XDATA_Z
 
 1 256 bytes of CODE  memory
    66 bytes of CONST memory
     0 bytes of DATA  memory (+ 1 byte shared)
    67 bytes of XDATA memory

Errors: none
Warnings: none
